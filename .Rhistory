odt
View(odt)
o2 <- read.csv('2.csv')
View(o2)
o2
o2[order(o25$t2)]
o2[order(o2$t2)]
o2[order(o2$t2),]
o2 <- o2[order(o2$t2),]
View(o2)
o2[order(o2$t2, decreasing = TRUE),]
o2 <- o2[order(o2$t2, decreasing = TRUE),]
o3 <- o3[order(o3$t2, decreasing = TRUE),]
o4 <- o4[order(o4$t2, decreasing = TRUE),]
o5 <- o5[order(o5$t2, decreasing = TRUE),]
o2 <- read.csv('2.csv')
o3 <- read.csv('3.csv')
o4 <- read.csv('4.csv')
o5 <- read.csv('5.csv')
o6 <- read.csv('6.csv')
o2 <- o2[order(o2$t2, decreasing = TRUE),]
o3 <- o3[order(o3$t2, decreasing = TRUE),]
o4 <- o4[order(o4$t2, decreasing = TRUE),]
o5 <- o5[order(o5$t2, decreasing = TRUE),]
o6 <- o6[order(o6$t2, decreasing = TRUE),]
View(o6)
View(o5)
View(o2)
View(o3)
View(o4)
View(o5)
View(o6)
odt
View(odt)
colnames(odt) <- c('Trait combination', 'Explained variance')
View(odt)
dplyr::bind_rows(odt, o2[1:10,])
View(odt)
x <- dplyr::bind_rows(odt, o2[1:10,])
View(testt)
View(x)
x <- dplyr::bind_rows(unname(odt), unname(o2[1:10,]))
x <- dplyr::bind_rows(odt, unname(o2[1:10,]))
View(x)
x <- dplyr::bind_rows(odt, c(o2$t1[1:10,]))
odt <- data.frame(a, b)
colnames(odt) <- c('t1', 't2')
x <- dplyr::bind_rows(odt, o2[1:10])
View(x)
View(odt)
x <- dplyr::bind_rows(odt, o2[1:10,])
odt <- dplyr::bind_rows(odt, o2[1:10,], o2[1:10,], o4[1:10,], o5[1:10,], o6[1:10,])
colnames(odt) <- c('Trait combination', 'Explained variance')
View(odt)
duplicated(odt)
odt(duplicated(odt)
odt[duplicated(odt)]
odt[duplicated(odt),]
duplicated(odt$`Trait combination`)
View(odt)
odt <- dplyr::bind_rows(odt, o2[1:20,], o2[1:10,], o4[1:10,], o5[1:10,], o6[1:10,])
a <- c()
b <- c()
#Seed C1
a <- append(a, paste(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight'), collapse = ', '))
b <- append(b, compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight')))
#Seed C2
compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk'))
a <- append(a, paste(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk'), collapse = ', '))
b <- append(b, compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk')))
#Salinity C3
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES')))
#Salinity C4
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES')))
#Salinity C5
compose(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A'))
a <- append(a, paste(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A'), collapse = ', '))
b <- append(b, compose(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A')))
#Salinity C6
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+')))
#Salinity C7
compose(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+')))
#Biomass C8
compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length'))
a <- append(a, paste(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length'), collapse = ', '))
b <- append(b, compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length')))
#Stress biomass C9
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length')))
#All biomass C10
compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'))
a <- append(a, paste(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'), collapse = ', '))
b <- append(b, compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length')))
compose(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+'))
a <- append(a, paste(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+')))
#Stress Na ions C12
compose(c('Stress_Shoot_Na+', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Shoot_Na+', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_Na+', 'Stress_Root_Na+')))
#Stress Root ions C13
compose(c('Stress_Root_Na+', 'Stress_Root_K+'))
a <- append(a, paste(c('Stress_Root_Na+', 'Stress_Root_K+'), collapse = ', '))
b <- append(b, compose(c('Stress_Root_Na+', 'Stress_Root_K+')))
#Lost biomass C14
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length')))
#All losses C15
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B')))
#Stress induced losses C16
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES')))
#Stress induced losses c17
compose(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES')))
#Biomass and chlorophyll C18
compose(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'))
a <- append(a, paste(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'), collapse = ', '))
b <- append(b, compose(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B')))
odt <- data.frame(a, b)
colnames(odt) <- c('t1', 't2')
duplicated(odt$t1)
o2 <- read.csv('2.csv')
o3 <- read.csv('3.csv')
o4 <- read.csv('4.csv')
o5 <- read.csv('5.csv')
o6 <- read.csv('6.csv')
o2 <- o2[order(o2$t2, decreasing = TRUE),]
o3 <- o3[order(o3$t2, decreasing = TRUE),]
o4 <- o4[order(o4$t2, decreasing = TRUE),]
o5 <- o5[order(o5$t2, decreasing = TRUE),]
o6 <- o6[order(o6$t2, decreasing = TRUE),]
odt <- dplyr::bind_rows(odt, o2[1:20,], o2[1:10,], o4[1:10,], o5[1:10,], o6[1:10,])
colnames(odt) <- c('Trait combination', 'Explained variance')
View(odt)
odt[-duplicated(odt$`Trait combination`)]
length(odt[-duplicated(odt$`Trait combination`)])
dim(odt[-duplicated(odt$`Trait combination`)])
dim(odt[!duplicated(odt$`Trait combination`)])
dim(odt[!duplicated(odt$`Trait combination`),])
dim(odt[-duplicated(odt$`Trait combination`),])
dim(odt[!duplicated(odt$`Trait combination`),])
sum(duplicated(o2))
a <- c()
b <- c()
#Seed C1
a <- append(a, paste(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight'), collapse = ', '))
b <- append(b, compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight')))
#Seed C2
compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk'))
a <- append(a, paste(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk'), collapse = ', '))
b <- append(b, compose(c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight',
'Length_WO_husk')))
#Salinity C3
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'SES')))
#Salinity C4
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length',  'Stress_Chlorophyll_A', 'Stress_Chlorophyll_B',
'SES')))
#Salinity C5
compose(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A'))
a <- append(a, paste(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A'), collapse = ', '))
b <- append(b, compose(c('Stress_Root_length', 'SES', 'Stress_Chlorophyll_A')))
#Salinity C6
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Chlorophyll_A',
'Stress_Root_length', 'SES', 'Stress_Root_Na+')))
#Salinity C7
compose(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Chlorophyll_A', 'Stress_Root_length',
'SES', 'Stress_Root_Na+')))
#Biomass C8
compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length'))
a <- append(a, paste(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length'), collapse = ', '))
b <- append(b, compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length')))
#Stress biomass C9
compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'))
a <- append(a, paste(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length')))
#All biomass C10
compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'))
a <- append(a, paste(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length'), collapse = ', '))
b <- append(b, compose(c('Shoot_weight', 'Root_weight', 'Shoot_length', 'Root_length',
'Stress_Shoot_weight', 'Stress_Root_weight', 'Stress_Shoot_length',
'Stress_Root_length')))
compose(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+'))
a <- append(a, paste(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_Na+', 'Stress_Shoot_K+',
'Stress_Root_Na+', 'Stress_Root_K+')))
#Stress Na ions C12
compose(c('Stress_Shoot_Na+', 'Stress_Root_Na+'))
a <- append(a, paste(c('Stress_Shoot_Na+', 'Stress_Root_Na+'), collapse = ', '))
b <- append(b, compose(c('Stress_Shoot_Na+', 'Stress_Root_Na+')))
#Stress Root ions C13
compose(c('Stress_Root_Na+', 'Stress_Root_K+'))
a <- append(a, paste(c('Stress_Root_Na+', 'Stress_Root_K+'), collapse = ', '))
b <- append(b, compose(c('Stress_Root_Na+', 'Stress_Root_K+')))
#Lost biomass C14
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length')))
#All losses C15
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Shoot_length',
'Lost_Root_length', 'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B')))
#Stress induced losses C16
compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Lost_Shoot_weight', 'Lost_Root_weight', 'Lost_Chlorophyll_A',
'SES')))
#Stress induced losses c17
compose(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES'))
a <- append(a, paste(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES'), collapse = ', '))
b <- append(b, compose(c('Lost_Root_length', 'Lost_Chlorophyll_A',
'SES')))
#Biomass and chlorophyll C18
compose(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'))
a <- append(a, paste(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B'), collapse = ', '))
b <- append(b, compose(c('Lost_Root_weight', 'Lost_Shoot_weight',
'Lost_Chlorophyll_A', 'Lost_Chlorophyll_B')))
odt <- data.frame(a, b)
colnames(odt) <- c('t1', 't2')
o2 <- read.csv('2.csv')
o3 <- read.csv('3.csv')
o4 <- read.csv('4.csv')
o5 <- read.csv('5.csv')
o6 <- read.csv('6.csv')
o2 <- o2[order(o2$t2, decreasing = TRUE),]
o3 <- o3[order(o3$t2, decreasing = TRUE),]
o4 <- o4[order(o4$t2, decreasing = TRUE),]
o5 <- o5[order(o5$t2, decreasing = TRUE),]
o6 <- o6[order(o6$t2, decreasing = TRUE),]
odt <- dplyr::bind_rows(odt, o2[1:21,], o2[1:10,], o4[1:10,], o5[1:10,], o6[1:10,])
colnames(odt) <- c('Trait combination', 'Explained variance')
odt <- odt[!duplicated(odt$`Trait combination`)]
odt <- odt[!duplicated(odt$`Trait combination`),]
sum(duplicated(o2))
View(odt)
write.csv('Composite_trait_combinations.csv',odt)
write.csv('Composite_trait_combinations.csv', odt)
write.csv(odt, 'Composite_trait_combinations.csv')
write_csv(odt, 'Composite_trait_combinations.csv')
write_csv(odt, 'Composite_trait_combinations.csv')
odt$`Trait combination`
strsplit('abc','b')
strsplit(odt$`Trait combination`, ', ')
for (i in strsplit(odt$`Trait combination`, ', ')) { print(i)}
strsplit(odt$`Trait combination`, ', ')[[1]]
for (i in 1:68) {
strsplit(odt$`Trait combination`, ', ')[[i]]
}
for (i in 1:68) {
print(strsplit(odt$`Trait combination`, ', ')[[i]])
}
print(compose(strsplit(odt$`Trait combination`, ', ')[[i]]))
for (i in 1:68) {
print(compose(strsplit(odt$`Trait combination`, ', ')[[i]]))
}
x <- data.frame()
for (i in 1:68) {
x <- dplyr::bind_cols(forge(strsplit(odt$`Trait combination`, ', ')[[i]]))
}
forge <- function(traits) {
wdf <- df[c('accession_name', traits)]
tdf <- na.omit(wdf[c(traits)])
mat <- data.matrix(tdf)
pca <- prcomp(mat, scale. = TRUE)
#plot(pca$x[,1], pca$x[,2])
pca.var <- pca$sdev^2
pca.var <- round(pca.var/sum(pca.var)*100, 1)
#barplot(pca.var[1:5], main = 'Scree Plot', xlab = 'Principal Component',
#        ylab = 'Percent Variation')
pca$x[,1]
}
x <- data.frame()
for (i in 1:68) {
x <- dplyr::bind_cols(forge(strsplit(odt$`Trait combination`, ', ')[[i]]))
}
View(x)
x <- data.frame()
for (i in 1:68) {
x <- dplyr::bind_cols(x, forge(strsplit(odt$`Trait combination`, ', ')[[i]]))
}
wdf <- df[c('accession_name', traits)]
traits <- c('Width_WO_husk', 'Height_WO_husk', 'Seed_Weight')
wdf <- df[c('accession_name', traits)]
wdf
adf <- wdf[na.omit(wdf)]
adf <- na.omit(wdf)
View(adf)
adf <- dplyr::bind_cols(adf$accession_name, pca$x[,1])
View(adf)
adf
dim(adf)
dim(pca$x[,1])
dim(pca$x[1,])
typeof(pca$x[,1])
length(pca$x[,1])
tdf <- na.omit(wdf[c(traits)])
mat <- data.matrix(tdf)
pca <- prcomp(mat, scale. = TRUE)
adf <- dplyr::bind_cols(adf$accession_name, pca$x[,1])
View(adf)
?merge
cdf <- merge(cdf, x, by = 'accession_name', all = TRUE)
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- cdf('accession_name', sprintf('C%d', 1))
for (i in 2:68) {
x <- forge(strsplit(odt$`Trait combination`, ', ')[[i]])
names(x) <- c('accession_name', sprintf('C%d', i))
cdf <- merge(cdf, x, by = 'accession_name', all = TRUE)
}
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- cdf('accession_name', sprintf('C%d', 1))
for (i in 2:68) {
x <- forge(strsplit(odt$`Trait combination`, ', ')[[i]])
names(x) <- c('accession_name', sprintf('C%d', i))
cdf <- merge(cdf, x, by = `accession_name`, all = TRUE)
}
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- cdf('accession_name', sprintf('C%d', 1))
forge <- function(traits) {
wdf <- df[c('accession_name', traits)]
adf <- na.omit(wdf)
tdf <- na.omit(wdf[c(traits)])
mat <- data.matrix(tdf)
pca <- prcomp(mat, scale. = TRUE)
#plot(pca$x[,1], pca$x[,2])
pca.var <- pca$sdev^2
pca.var <- round(pca.var/sum(pca.var)*100, 1)
#barplot(pca.var[1:5], main = 'Scree Plot', xlab = 'Principal Component',
#        ylab = 'Percent Variation')
adf <- dplyr::bind_cols(adf$accession_name, pca$x[,1])
adf
}
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- cdf('accession_name', sprintf('C%d', 1))
for (i in 2:68) {
x <- forge(strsplit(odt$`Trait combination`, ', ')[[i]])
names(x) <- c('accession_name', sprintf('C%d', i))
cdf <- merge(cdf, x, by = 'accession_name', all = TRUE)
}
View(cdf)
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- cdf('accession_name', sprintf('C%d', 1))
cdf <- forge(strsplit(odt$`Trait combination`, ', ')[[1]])
names(cdf) <- c('accession_name', sprintf('C%d', 1))
View(cdf)
for (i in 2:68) {
x <- forge(strsplit(odt$`Trait combination`, ', ')[[i]])
names(x) <- c('accession_name', sprintf('C%d', i))
cdf <- merge(cdf, x, by = 'accession_name', all = TRUE)
}
View(cdf)
write_csv(cdf, '68composite.csv')
write.table(cdf, '68composite.csv')
write.table(cdf, '68composite.txt')
?write.table
write.table(cdf, '68composite.txt', row.names = FALSE)
write.table(cdf, '68composite.txt', row.names = FALSE, sep = '\t')
View(df)
which(is.na(myY))
myY <- read.table('../../Data/39transformed_WF2.txt', header = TRUE)
which(is.na(df))
which(is.na(df[,2]))
which(!is.na(df[,2]))
myY[1,]
df[,2]
dplyr::bind_cols(df[,2], df[,3])
df[,1]
x <- df[,1]
names(x)
install.packages('SNPassoc')
install.packages('SNPassoc')
install.packages('SNPassoc')
install.packages('SNPassoc')
library(SNPassoc)
# Next steps may be very time consuming. So they are not executed
data(HapMap)
View(HapMap)
# Next steps may be very time consuming. So they are not executed
data(HapMap)
myDat<-setupSNP(HapMap, colSNPs=3:9307, sort = TRUE,
info=HapMap.SNPs.pos, sep="")
View(myDat)
myDat<-setupSNP(HapMap, colSNPs=3:1000, sort = TRUE,
info=HapMap.SNPs.pos, sep="")
resHapMap<-scanWGassociation(group~1, data=myDat, model="log")
resHapMap<-WGassociation(group~1, data=myDat, model="log")
View(resHapMap)
permTest(resHapMap, 'minimum')
?WGassociation
?scanWGassociation
resHapMap<-scanWGassociation(group~1, data=myDat, model="log", nperm = 200)
library(devtools)
install.packages('devtools')
install.packages("devtools")
library(devtools)
install_githuib("isglobal-brge/SNPassoc")
devtools::install_githuib("isglobal-brge/SNPassoc")
install_github("isglobal-brge/SNPassoc")
install_github("isglobal-brge/SNPassoc")
install_github("isglobal-brge/SNPassoc")
iinstall.packages('digest')
install.packages('digest')
install.packages("digest")
install_github("isglobal-brge/SNPassoc")
library(devtools)
install_github("isglobal-brge/SNPassoc")
install.packages("biomaRt")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biomaRt")
